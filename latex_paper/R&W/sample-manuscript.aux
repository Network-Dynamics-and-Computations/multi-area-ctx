\relax 
\@writefile{lof}{\contentsline {figure}{\numberline {1}{\ignorespaces \textbf  {Relevant and irrelevant stimuli are encoded in different subspaces in A1.} \textbf  {a)} Left, schematics of the auditory discrimination go/no-go task. Rats were presented with an auditory stimulus with two features (pitch and location). Two example trials (black vs gray rat) for the same stimuli (in orange, a noise burst on the left speaker and in gray a high pitch warble on both speakers) in different contexts (location, black; pitch, gray). Depending on the context, the animals had to attend to one of the stimulus features and respond accordingly: go left in location context or no go in the pich context, for this stimulus pair. Right top, context-dependent go/no-go task rules specifying rewarded behavior for all stimulus pairs. Highlighted (black box) is the stimulus pair illustrated on the left. Bottom, both features are significantly decodable from A1, whether relevant (orange) or irrelevant (gray) (Rodgers and DeWeese, 2014). \textbf  {b)} Three possible scenarios for the encoding of the same feature depending on its relevance in each of the two contexts (orange and gray), as characterized by the geometric relationship of the coding axes across contexts. Different transparency levels refer to different conditions (e.g. left vs right location). Left: Identical encoding, where the coding axes are parallel in the two contexts; middle: enhanced encoding, where the go stimulus is enhanced by adding activity along a selection axis; right: independent encoding, corresponding to orthogonal coding axes. Bottom: to distinguish between scenarios, we project the trials in one context (colored histograms) onto the decoding axis (colored line) determined in the other context and inspect the resulting discrimination performance. \textbf  {c)} Across-context decoding (Across-context decoding in Methods) of location during pitch context and during location context. Left, irrelevant decoders work well both on irrelevant (gray) and relevant trials (orange). Right, relevant decoders work substantially better in relevant trials than in irrelevant trials. Shaded area marks the stimulus presentation period. \textbf  {d)} On the left, the angles between sensory and selection axis (before orthogonalization, Across-context decoding in Methods) estimated during location blocks. On the right, visualization of the activity elicited by relevant and irrelevant stimuli within the sensory-selection subspace. Colored circles mark the stimulus onset. \textbf  {e)} Same as d, but for the pitch context. Error-bars are bootstrapped 90\% C.I., except in d,e) where they mark the extrema bootstrap.}}{3}{}\protected@file@percent }
\newlabel{fig1}{{1}{3}}
\@writefile{lof}{\contentsline {figure}{\numberline {2}{\ignorespaces \textbf  {Trained RNN replicates A1 dynamics and predicts that population gating supports flexible selection of the relevant stimuli.} \textbf  {a)} Top, schematics of the RNN. On each trial, the RNN receives 4 inputs (stimuli and contexts) and must output the correct choice (-1, 0 or +1, representing go left, no go or go right) onto a fixed readout axis. Depicted in black are the weights that are trained with backpropagation (i.e. contextual inputs and recurrent weights) and in gray those that remain fixed (i.e. stimuli input and readout). Bottom, average responses of trained (left) and resampled (right) networks separated by conditions and context (compare with schematics in Fig. 1a). Left, trained networks achieve perfect accuracy in both contexts. Right, clustering and resampling connectivity (Inferring populations in Methods) from a distribution based on an increasing number of populations shows at least 3 populations (population A, B and 0) are necessary to solve the task with comparable accuracy to trained networks (left). \textbf  {b)} Similar to A1, the network represents both stimuli but enhances the relevant go stimuli along an additional axis. Colored circles mark the stimulus onset. \textbf  {c)} Dynamics of activity of populations A and B projected on the output axis is reduced in opposite contexts, effectively gating the relevant go stimulus into the output axis (b). \textbf  {d)} Single neurons in each population have different gains in the two contexts (here shown only for population B). This is reflected both in the slope of the transfer function (left, $\phi '$) and in the single-neuron firing rate before the stimulus (right). \textbf  {e} The model predicts that the pre-stimulus firing rate can identify the 3 populations. }}{5}{}\protected@file@percent }
\newlabel{fig2}{{2}{5}}
\@writefile{lof}{\contentsline {figure}{\numberline {3}{\ignorespaces \textbf  {Pre-stimulus context-dependent activity reveals a subpopulation structure in A1, as predicted by the model.} \textbf  {a)} Neurons are grouped in three populations, based on their pre-stimulus firing rate modulation to context. In black, the mean (circle) and [2.5, 97.5] percentiles (bar) of firing rate modulation to context of shuffled trials within neurons. \textbf  {b)} Neurons in the pitch- and location-population (right and left slim bars, respectively) are mixed selective (Single-neuron selectivity in Methods), although a small fraction showed pure selectivity to some of the task variables (gray). \textbf  {c)} Projection of stimulus responses of go left / right (orange) and no go (gray) onto the output axis for the location population (top) and pitch population (bottom). Different populations select the relevant go stimuli in different contexts. Left, projections of trials recorded during the location context. Right, equivalently for the pitch context. See Fig. S3 for the projections of individual stimuli here grouped as go left/right and no go. \textbf  {d)} Permutation test shows output gating in c) is not visible in randomly picked populations (gray, Methods). Top, location-population has an output gating ratio (blue vertical bar) higher than chance (p=0.03). Bottom, pitch-population has gain modulation higher than chance (p=0.004). Population 0 (black vertical bar in both plots) did not show above chance gain modulation (p>0.25). All error-bars are bootstrapped standard errors of the mean. }}{8}{}\protected@file@percent }
\newlabel{fig3}{{3}{8}}
\@writefile{lof}{\contentsline {figure}{\numberline {4}{\ignorespaces \textbf  {PFC encodes only the selected stimuli along the selection axis.} \textbf  {a)} Across-context decoding (Across-context decoding in Methods) of location during pitch context and during location context. Lext, relevant decoders work well in relevant trials but not irrelevant trials. Right, irrelevant decoders fail both on irrelevant (gray) and relevant trials (orange). Shaded area marks the stimulus presentation period. Error-bars are bootstrap 90\% C.I. See also Fig. 1c. \textbf  {b)} visualization of the activity elicited by relevant and irrelevant stimuli within the sensory-selection subspace. Colored circles mark the stimulus onset. See also Fig. 1d,e.}}{9}{}\protected@file@percent }
\newlabel{fig4}{{4}{9}}
\@writefile{lof}{\contentsline {figure}{\numberline {5}{\ignorespaces \textbf  {Figure 5. Engineered multi-area model replicates A1 and PFC dynamics and produces predictions for across-area interactions.} \textbf  {a)} The interaction between A1 and PFC was set to occur through low-rank connectivity in opposite directions (feedforward in orange and feedback in gray). In contrast to the trained network, context is delivered transiently to PFC (dashed), stored in persistent activity and fed back to A1 (context, gray). In turn, stimuli are delivered to A1 and are not communicated to PFC, thus remaining in a “private subspace” of A1 (inset, bottom left). The relevant stimulus, which is selected within A1 by integrating the stimuli and context, is communicated to PFC along the selection axis (selection, orange). \textbf  {b)} Estimation of the communication subspaces using canonical correlation analyses separately for each context (Communication subspace estimation in Methods). On the left, cross-validated correlation along different canonical dimensions is significant for two dimensions (error bars are 95\% C.I.). A1 and PFC communicate through orthogonal communication subspaces in opposite contexts (red and blue), despite the model having fixed connectivity (gray). On the right, different populations participate in the communication subspace in different contexts. Population A has 0 loadings on the communication subspace during context B (here shown the first canonical dimension); conversely for population B.}}{10}{}\protected@file@percent }
\newlabel{fig5}{{5}{10}}
\bibdata{paperpile}
\@writefile{lof}{\contentsline {figure}{\numberline {6}{\ignorespaces \textbf  {A1 and PFC encode different task variables.} \textbf  {a)} Logistic regression decoding (Methods) of location (left), pitch (right) in each context (red and blue) and decoding of context overlaid on both plots for comparison. Top, A1 encodes both stimulus’ features in either contexts. Bottom, PFC encodes only the relevant stimulus’ features for the ongoing context. \textbf  {b)} Left, feature-selectivity is mixed in both areas. Right, fraction of cells with significant task-variables regressors (Methods). Error-bars are bootstrapped SEM.}}{21}{}\protected@file@percent }
\newlabel{figS1}{{6}{21}}
\@writefile{lof}{\contentsline {figure}{\numberline {7}{\ignorespaces \textbf  {Network and low-dimensional model of a context-dependent go/no-go task.} \textbf  {a,b)} Same as Fig. 2c and d, but showing data from all three populations. \textbf  {c)} Context weights optimized through training have different variances for each population, the mechanism supporting gain modulation (Dubreuil et al., 2022). Population A and B have a larger range of weights for context B and A, respectively. Population 0 has the same range of weights for both contextual inputs. \textbf  {d)} Populations A and B showed substantially more context-dependent activity along the readout axis than population 0 as measured with output-gating ratio (Methods). \textbf  {e)} Dynamics of kappa separated for each population (color lines) and collectively for all populations (gray) for both contexts and all stimuli combinations. Here it can be seen that population 0 (green) contributes equally for all contexts and stimulus conditions. Namely, it pushes the dynamics of kappa towards 0, essential to have a fixed corresponding to the no go conditions (two bottom conditions for context A, on the left; and two left conditions for context B, on the right). In contrast, population A (orange) and B (blue) are inactive during context B and A, respectively, and do not contribute to the dynamics during those conditions. On the other hand, the same populations are active in opposite contexts and integrate the relevant stimulus into kappa dynamics (e.g. orange lines in context A when input A < 0). \textbf  {f)} Top, dynamics of the low-dimensional model for all trials. Bottom, dynamics a network with weights sampled from the distribution defined in f (Methods). Quantitative differences due to finite-size effects and reduced when using larger networks. }}{22}{}\protected@file@percent }
\newlabel{figS2}{{7}{22}}
\@writefile{lof}{\contentsline {figure}{\numberline {8}{\ignorespaces Same as Fig. 3, but separating by stimuli. Go stimuli for the location context (left) in orange and blue. Go stimuli for the pitch context (low) in red and orange.}}{23}{}\protected@file@percent }
\newlabel{figS3}{{8}{23}}
\@writefile{lof}{\contentsline {figure}{\numberline {9}{\ignorespaces \textbf  {a)} A1 and PFC in isolation did not integrate the relevant stimulus in a context-dependent fashion (unconnected), but they did when set up to cooperate through communication subspaces (connected). We found that connecting these two areas drove A1 to integrate into the recurrent dynamics the relevant, but ignore the irrelevant stimulus. Moreover, meaningful choices could be read out from PFC instead of A1 (black triangles). In the figure we illustrate two trials. Specifically, the projection of the network activity on different connectivity vectors: $I_A,I_B$ in purple and yellow, respectively; $m_A,m_p$ in red/blue and gray, respectively; and on the input-selector vector from A1 to PFC (Methods), red/blue. \textbf  {b)} When unconnected, the two areas do not show context-dependent behavior, but they do so when set to interact through low-rank connectivity. \textbf  {c)} principal angle between different subspaces (Methods). Communication subspaces inferred during opposite contexts are almost orthogonal (purple). In red and blue, the angle between the subspaces estimated with canonical correlation analysis and those defined by the network connectivity. For comparison, colored triangles mark the angle between connectivity subspaces and those determined by decoding context and decision from each area; black triangle marks the mean angle between the same subspaces estimated from different folds (Methods), the minimum empirical distance possible between subspaces. \textbf  {d)} As described in the methods, we only used the first PCs of the neural to estimate the communication subspace using CCA. This is a typical preprocessing step (e.g. (Gallego et al., 2018)). We found empirically that the estimated subspace is sensible to the number of PCs we kept (manifold size). For the purpose of Fig. 4, we only kept the first 9 PCs.}}{24}{}\protected@file@percent }
\newlabel{figS4}{{9}{24}}
\@writefile{lof}{\contentsline {figure}{\numberline {10}{\ignorespaces Top, same as Fig. 1 but for pitch instead of location. Error-bars are bootstrap SEM. Bottom, cross-correlation of decoding weights for different axes. In a.3, it can be seen that the relevant stimuli code has two components, one during the stimulus and another one during responses. On the other hand, for PFC (b.3), the code seems to unfold along similar codes during stimulus and response.}}{25}{}\protected@file@percent }
\newlabel{figS5}{{10}{25}}
\gdef \@abspage@last{25}
